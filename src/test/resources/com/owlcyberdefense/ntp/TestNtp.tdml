<?xml version="1.0" encoding="UTF-8"?>
<!--
Copyright (c) 2012-2026 Owl Cyber Defense. All rights reserved.
Please see the accompanying COPYRIGHT.txt file for terms of use.
-->
<testSuite suiteName="Ntp" description="Ntp tests"
  xmlns:tdml="http://www.ibm.com/xmlns/dfdl/testData"
  xmlns="http://www.ibm.com/xmlns/dfdl/testData"
  xmlns:xs="http://www.w3.org/2001/XMLSchema"
  xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
  defaultRoundTrip="onePass">

  <parserTestCase name="test_bits_01" root="ntp" model="/dfdl-ntp.bin">

    <!--
    build up a message field by field using TDML features that
    enable specifying bits and bytes of binary data.
    -->
    <document>
      <!--LI-->
      <documentPart type="bits">
        11
      </documentPart>

      <!--VN-->
      <documentPart type="bits">
        011
      </documentPart>

      <!--Mode-->
      <documentPart type="bits">
        001
      </documentPart>

      <!--Stratum-->
      <documentPart type="byte">
        00
      </documentPart>

      <!--Poll-->
      <documentPart type="byte">
        0a
      </documentPart>

      <!--Precision-->
      <documentPart type="byte">
        fa
      </documentPart>

      <!--Root Delay-->
      <documentPart type="byte">
        00 00 00 00
      </documentPart>

      <!--Root Dispersion-->
      <documentPart type="byte">
        00 01 02 90 
      </documentPart>

      <!--Reference ID-->
      <documentPart type="byte">
        00 00 00 00
      </documentPart>

      <!--Reference TS-->
      <documentPart type="byte">
        00 00 00 00 00 00 00 00
      </documentPart>

      <!--Origin TS-->
      <documentPart type="byte">
        00 00 00 00 00 00 00 00
      </documentPart>

      <!--Receive TS-->
      <documentPart type="byte">
        00 00 00 00 00 00 00 00
      </documentPart>

      <!--Transit TS-->
      <documentPart type="byte">
        c5 02 04 ec ec 42 ee 92
      </documentPart>
      
    </document>

    <infoset>
      <dfdlInfoset>
        <ntp xmlns=""><!-- needs xmlns="" since the default namespace is the TDML namespace -->
          <LI>3</LI>
          <VN>3</VN>
          <Mode>1</Mode>
          <Stratum>0</Stratum>
          <Poll>10</Poll>
          <Precision>250</Precision>
          <RootDelay>
            <seconds>0</seconds>
            <fraction>0</fraction>
          </RootDelay>
          <RootDispersion>
            <seconds>1</seconds>
            <fraction>656</fraction>
          </RootDispersion>
          <ReferenceID>0</ReferenceID>
          <ReferenceTimeStamp>
            <seconds>0</seconds>
            <fraction>0</fraction>
          </ReferenceTimeStamp>
          <OriginTimeStamp>
            <seconds>0</seconds>
            <fraction>0</fraction>
          </OriginTimeStamp>
          <ReceiveTimeStamp>
            <seconds>0</seconds>
            <fraction>0</fraction>
          </ReceiveTimeStamp>
          <TransmitTimeStamp>
            <seconds>3305243884</seconds>
            <fraction>-331157870</fraction>
          </TransmitTimeStamp>
        </ntp>
      </dfdlInfoset>
    </infoset>
    
  </parserTestCase>

  <parserTestCase name="test_all_ff_01" root="ntp" model="/dfdl-ntp.bin">
    <document>
      <documentPart type="byte"><![CDATA[
                              ff ff ff ff ff ff
ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff
ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff
ff ff ff ff ff ff ff ff ff ff
]]></documentPart>
    </document>
    <infoset>
      <dfdlInfoset>
        <ntp xmlns=""><!-- needs xmlns="" since the default namespace is the TDML namespace -->
          <LI>3</LI>
          <VN>7</VN>
          <Mode>7</Mode>
          <Stratum>255</Stratum>
          <Poll>255</Poll>
          <Precision>255</Precision>
          <RootDelay>
            <seconds>65535</seconds>
            <fraction>-1</fraction>
          </RootDelay>
          <RootDispersion>
            <seconds>65535</seconds>
            <fraction>-1</fraction>
          </RootDispersion>
          <ReferenceID>-1</ReferenceID>
          <ReferenceTimeStamp>
            <seconds>4294967295</seconds>
            <fraction>-1</fraction>
          </ReferenceTimeStamp>
          <OriginTimeStamp>
            <seconds>4294967295</seconds>
            <fraction>-1</fraction>
          </OriginTimeStamp>
          <ReceiveTimeStamp>
            <seconds>4294967295</seconds>
            <fraction>-1</fraction>
          </ReceiveTimeStamp>
          <TransmitTimeStamp>
            <seconds>4294967295</seconds>
            <fraction>-1</fraction>
          </TransmitTimeStamp>
        </ntp>
      </dfdlInfoset>
    </infoset>

  </parserTestCase>

  <!--
  if you want to create TDML tests for the data files in the data subdir
  copy and modify this test case below
  -->
  <parserTestCase name="test_data_0" root="ntp" model="/dfdl-ntp.bin">
    <document>
      <documentPart type="file">com/owlcyberdefense/ntp/data/0.dat</documentPart>
    </document>
    <tdml:infoset>
      <tdml:dfdlInfoset type="file">com/owlcyberdefense/ntp/infosets/0.dat.xml</tdml:dfdlInfoset>
    </tdml:infoset>
  </parserTestCase>

</testSuite>
